(this["webpackJsonpprojects-board"]=this["webpackJsonpprojects-board"]||[]).push([[0],{128:function(e,t,n){},190:function(e,t,n){},267:function(e,t,n){},269:function(e,t,n){"use strict";n.r(t);var r=n(9),i=n(0),c=n.n(i),a=n(28),o=n.n(a),s=(n(190),n(7)),l=n(17),d=n(272),j=n(277),u=n(278),b=n(279),O=n(280),m=n(54);function f(){var e=Object(m.a)(["\n  query($id: ID!) {\n    Project(id: $id) {\n      Users {\n        id\n        first_name\n        last_name\n        avatar\n        email\n        project_id\n      }\n    }\n  }\n"]);return f=function(){return e},e}function p(){var e=Object(m.a)(["\n  query {\n    allUsers {\n      id\n      email\n      first_name\n      last_name\n    }\n  }\n"]);return p=function(){return e},e}function h(){var e=Object(m.a)(["\n  query {\n    allProjects {\n      id\n      name\n      Users {\n        id\n      }\n    }\n  }\n"]);return h=function(){return e},e}function v(){var e=Object(m.a)(["\n  query($id: ID!) {\n    Project(id: $id) {\n      id\n      name\n      Enterprise {\n        id\n        name\n      }\n    }\n  }\n"]);return v=function(){return e},e}function x(){var e=Object(m.a)(["\n  query {\n    allEnterprises {\n      id\n      name\n    }\n  }\n"]);return x=function(){return e},e}var P=Object(l.gql)(x()),g=Object(l.gql)(v()),_=Object(l.gql)(h()),I=Object(l.gql)(p()),C=Object(l.gql)(f());function y(){var e=Object(m.a)(["\n  mutation($id: ID!, $project_id: ID) {\n    updateUser(id: $id, project_id: $project_id) {\n      id\n      project_id\n    }\n  }\n"]);return y=function(){return e},e}function N(){var e=Object(m.a)(["\n  mutation($id: ID!) {\n    removeProject(id: $id)\n  }\n"]);return N=function(){return e},e}function E(){var e=Object(m.a)(["\n  mutation($id: ID!, $name: String!, $enterprise_id: ID!) {\n    createProject(id: $id, name: $name, enterprise_id: $enterprise_id) {\n      id\n    }\n  }\n"]);return E=function(){return e},e}function S(){var e=Object(m.a)(["\n  mutation($id: ID!, $name: String, $enterprise_id: ID) {\n    updateProject(id: $id, name: $name, enterprise_id: $enterprise_id) {\n      id\n      name\n      enterprise_id\n      Enterprise {\n        id\n        name\n      }\n      Users {\n        id\n      }\n    }\n  }\n"]);return S=function(){return e},e}var M=Object(l.gql)(S()),$=Object(l.gql)(E()),q=Object(l.gql)(N()),U=Object(l.gql)(y()),T=n(273),w=n(65),D=n(274),A=n(75),L=n(276),V=(n(128),T.a.Text),k=w.a.Option;function Q(e){var t=Object(i.useState)(""),n=Object(s.a)(t,2),c=n[0],a=n[1],o=Object(i.useState)(""),d=Object(s.a)(o,2),j=d[0],u=d[1],b=e.selectedProjectId,O=e.isEditProjectModalVisible,m=e.setIsEditProjectModalVisible,f=Object(l.useQuery)(P),p=f.loading,h=f.error,v=f.data,x=Object(l.useQuery)(g,{variables:{id:b},onCompleted:function(e){a(e.Project.name),u(e.Project.Enterprise.id)}}),I=x.loading,C=x.error,y=x.data,N=Object(l.useMutation)(M),E=Object(s.a)(N,2),S=E[0],$=E[1],q=$.loading,U=$.error;if(p||I||q)return null;if(h||C||U)return Object(r.jsx)("p",{children:"Error"});function T(){S({variables:{id:b,name:c,enterprise_id:j},refetchQueries:[{query:_}]}),m(!1)}return y?Object(r.jsx)("div",{className:"EditProjectModal",children:Object(r.jsxs)(D.a,{className:"Modal",title:"Edit ".concat(c),visible:O,onOk:T,onCancel:function(){m(!1)},footer:Object(r.jsx)(A.a,{disabled:""===c||""===j,type:"primary",onClick:T,children:"Edit Project"},"submit"),children:[Object(r.jsxs)("div",{className:"formContainer",children:[Object(r.jsx)(V,{id:"projectTitle",strong:!0,children:"Project's name"}),Object(r.jsx)(L.a,{defaultValue:y.Project.name,onChange:function(e){return a(e.target.value)}})]}),Object(r.jsxs)("div",{className:"formContainer",children:[Object(r.jsx)(V,{id:"enterpriseTitle",strong:!0,children:"Enterprise"}),Object(r.jsx)(w.a,{value:j,showSearch:!0,optionFilterProp:"children",onChange:function(e){u(e)},filterOption:function(e,t){return t.children.toLowerCase().indexOf(e.toLowerCase())>=0},children:v.allEnterprises.map((function(e){return Object(r.jsx)(k,{value:e.id,children:e.name},e.id)}))})]})]})}):null}var F=n(11);function W(){var e=Object(m.a)(["\n                fragment NewProject on Project {\n                  id\n                }\n              "]);return W=function(){return e},e}var B=w.a.Option,H=T.a.Text;function R(e){var t=Object(i.useState)(""),n=Object(s.a)(t,2),c=n[0],a=n[1],o=Object(i.useState)(""),d=Object(s.a)(o,2),j=d[0],u=d[1],b=e.isAddProjectModalVisible,O=e.setIsAddProjectModalVisible,m=Object(l.useQuery)(P),f=m.loading,p=m.error,h=m.data,v=Object(l.useMutation)($,{update:function(e,t){var n=t.data.createProject;e.modify({fields:{allProjects:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=e.writeFragment({data:n,fragment:Object(l.gql)(W())});return[].concat(Object(F.a)(t),[r])}}})}}),x=Object(s.a)(v,2),g=x[0],_=x[1],I=_.loading,C=_.error;if(f||I)return null;if(p||C)return Object(r.jsx)("p",{children:"Error"});function y(){g({variables:{id:Date.now(),name:c,enterprise_id:j}}),O(!1)}return Object(r.jsx)("div",{className:"AddProjectModal",children:Object(r.jsxs)(D.a,{className:"Modal",title:"Add Project",visible:b,onOk:y,onCancel:function(){O(!1)},footer:Object(r.jsx)(A.a,{disabled:""===c||""===j,type:"primary",onClick:y,children:"Add Project"},"submit"),children:[Object(r.jsxs)("div",{className:"formContainer",children:[Object(r.jsx)(H,{id:"projectTitle",strong:!0,children:"Project's name"}),Object(r.jsx)(L.a,{className:"projectInputBox",placeholder:"e.g: Spotify",onChange:function(e){a(e.target.value)}})]}),Object(r.jsxs)("div",{className:"formContainer",children:[Object(r.jsx)(H,{id:"enterpriseTitle",strong:!0,children:"Enterprise"}),Object(r.jsx)(w.a,{showSearch:!0,placeholder:"Quop",optionFilterProp:"children",onChange:function(e){u(e)},filterOption:function(e,t){return t.children.toLowerCase().indexOf(e.toLowerCase())>=0},children:h.allEnterprises.map((function(e){return Object(r.jsx)(B,{value:e.id,children:e.name},e.id)}))})]})]})})}var K=n(271),z=n(275),J=K.a.Option;function G(e){var t=Object(i.useState)(null),n=Object(s.a)(t,2),c=n[0],a=n[1],o=Object(i.useState)(!1),j=Object(s.a)(o,2),u=j[0],b=j[1],O=Object(i.useState)([]),m=Object(s.a)(O,2),f=m[0],p=m[1],h=e.isUserModalVisible,v=e.setIsUserModalVisible,x=Object(l.useQuery)(C,{variables:{id:e.selectedProjectId}}),P=x.loading,g=x.error,y=x.data,N=Object(l.useQuery)(I),E=N.loading,S=N.error,M=N.data,$=Object(l.useMutation)(U,{refetchQueries:[{query:C,variables:{id:e.selectedProjectId}},{query:_}]}),q=Object(s.a)($,1)[0];if(P||E)return null;if(g||S)return Object(r.jsx)("p",{children:"Error"});return Object(r.jsx)("div",{className:"UserModal",children:Object(r.jsx)(D.a,{className:"Modal",title:"Users settings",visible:h,onCancel:function(){return v(!1)},footer:u?Object(r.jsx)(K.a,{allowClear:!0,autoFocus:!0,className:"autoCompleteBox",onChange:function(e){var t=[];t=e?function(){var e=M.allUsers,t=y.Project.Users.map((function(e){return e.id}));return e.filter((function(e){if(!t.includes(e.id))return e}))}().filter((function(t){return[t.first_name,t.last_name,t.email].some((function(t){return t.toUpperCase().includes(e.toUpperCase())}))})):[],p(t)},onSelect:function(t,n){q({variables:{id:n.key,project_id:e.selectedProjectId}})},placeholder:"ex: firstname.lastname@provider.com",children:f.map((function(e){return Object(r.jsx)(J,{value:"".concat(e.first_name," ").concat(e.last_name),children:Object(r.jsxs)("div",{className:"searchOption",children:[Object(r.jsx)("p",{children:"".concat(e.first_name," ").concat(e.last_name)}),Object(r.jsx)("span",{children:e.email})]})},e.id)}))}):Object(r.jsx)("p",{className:"inviteText",onClick:function(){return b(!0)},children:"Invite new users"}),children:Object(r.jsx)(d.b,{itemLayout:"horizontal",dataSource:y.Project.Users,renderItem:function(e,t){return Object(r.jsx)(d.b.Item,{onMouseEnter:function(){return a(t)},onMouseLeave:function(){return a(null)},actions:[c===t&&Object(r.jsx)("a",{href:"/#",onClick:function(){return t=e.id,void q({variables:{id:t,project_id:null}});var t},children:"Delete"})],children:Object(r.jsx)(d.b.Item.Meta,{avatar:Object(r.jsx)(z.a,{src:e.avatar}),title:"".concat(e.first_name," ").concat(e.last_name),description:e.email})})}})})})}n(267);var X=function(){var e=Object(i.useState)(""),t=Object(s.a)(e,2),n=t[0],c=t[1],a=Object(i.useState)(!1),o=Object(s.a)(a,2),m=o[0],f=o[1],p=Object(i.useState)(!1),h=Object(s.a)(p,2),v=h[0],x=h[1],P=Object(i.useState)(!1),g=Object(s.a)(P,2),I=g[0],C=g[1],y=Object(l.useQuery)(_),N=y.loading,E=y.error,S=y.data,M=Object(l.useMutation)(q,{errorPolicy:"ignore"}),$=Object(s.a)(M,1)[0];return N?Object(r.jsx)("p",{id:"loading",children:"Loading..."}):E?Object(r.jsx)("p",{children:"Error"}):Object(r.jsxs)("div",{className:"App",children:[m&&Object(r.jsx)(R,{isAddProjectModalVisible:m,setIsAddProjectModalVisible:f}),v&&Object(r.jsx)(G,{selectedProjectId:n,isUserModalVisible:v,setIsUserModalVisible:x}),I&&Object(r.jsx)(Q,{selectedProjectId:n,isEditProjectModalVisible:I,setIsEditProjectModalVisible:C}),Object(r.jsx)("div",{className:"WelcomeTextContainer",children:Object(r.jsx)("h1",{className:"WelcomeText",children:"Welcome to your projects board"})}),Object(r.jsx)(d.b,{header:[Object(r.jsxs)("div",{className:"Header",children:[Object(r.jsx)("h2",{className:"HeaderTitle",children:"Projects"}),Object(r.jsx)(j.a,{className:"Icon",onClick:function(){f(!0)}})]},"header")],className:"ProjectList",itemLayout:"horizontal",dataSource:S.allProjects,renderItem:function(e){return Object(r.jsx)(d.b.Item,{className:"ListItem",actions:[Object(r.jsx)(u.a,{className:"Icon",onClick:function(){return t=e.id,c(t),void x(!0);var t}}),Object(r.jsx)(b.a,{className:"Icon",onClick:function(){return t=e.id,c(t),void C(!0);var t}}),Object(r.jsx)(O.a,{id:"deleteButton",className:"Icon",onClick:function(){return t=e.id,void $({variables:{id:t},update:function(e){var n=e.readQuery({query:_}).allProjects.filter((function(e){return e.id!==t}));e.writeQuery({query:_,data:{allProjects:{newProjects:n}}})}});var t}})],children:Object(r.jsx)(d.b.Item.Meta,{className:"ListItem",title:Object(r.jsx)("p",{className:"ProjectTitles",children:e.name}),description:Object(r.jsx)("p",{className:"ProjectDescriptions",children:e.Users.length+" collaborators"})})})}})]})},Y=new l.InMemoryCache({typePolicies:{Query:{fields:{allProjects:{merge:function(e,t){return t}}}},Project:{fields:{Users:{merge:function(e,t){return t}}}}}}),Z=new l.ApolloClient({uri:Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_GQL_API||"http://localhost:5000/graphql",cache:Y});o.a.render(Object(r.jsx)(c.a.StrictMode,{children:Object(r.jsx)(l.ApolloProvider,{client:Z,children:Object(r.jsx)(X,{})})}),document.getElementById("root"))}},[[269,1,2]]]);
//# sourceMappingURL=main.7b18aba6.chunk.js.map